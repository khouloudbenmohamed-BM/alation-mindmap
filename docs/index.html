<!doctype html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<title>Markmap - Multi Pages</title>
<style>
* {
  margin: 0;
  padding: 0;
}
html {
  font-family: ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji',
    'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
}

/* Navigation Menu */
#nav-menu {
  position: fixed;
  top: 0;
  left: 0;
  width: 250px;
  height: 100vh;
  background: #1e293b;
  color: white;
  padding: 20px;
  box-shadow: 2px 0 5px rgba(0,0,0,0.1);
  overflow-y: auto;
  z-index: 1000;
}

#nav-menu h2 {
  margin-bottom: 20px;
  font-size: 1.5em;
  border-bottom: 2px solid #3b82f6;
  padding-bottom: 10px;
}

.nav-item {
  padding: 12px 15px;
  margin: 5px 0;
  cursor: pointer;
  border-radius: 5px;
  transition: background 0.3s;
  background: #334155;
}

.nav-item:hover {
  background: #475569;
}

.nav-item.active {
  background: #3b82f6;
  font-weight: bold;
}

#mindmap {
  display: block;
  width: calc(100vw - 250px);
  height: 100vh;
  margin-left: 250px;
}

.markmap-dark {
  background: #27272a;
  color: white;
}

/* Toggle button for mobile */
#menu-toggle {
  display: none;
  position: fixed;
  top: 10px;
  left: 10px;
  z-index: 1001;
  background: #3b82f6;
  color: white;
  border: none;
  padding: 10px 15px;
  border-radius: 5px;
  cursor: pointer;
}

@media (max-width: 768px) {
  #nav-menu {
    transform: translateX(-100%);
    transition: transform 0.3s;
  }
  
  #nav-menu.open {
    transform: translateX(0);
  }
  
  #mindmap {
    width: 100vw;
    margin-left: 0;
  }
  
  #menu-toggle {
    display: block;
  }
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.12/dist/style.css">
</head>
<body>

<!-- Navigation Menu -->
<button id="menu-toggle">☰ Menu</button>
<nav id="nav-menu">
  <h2>Mindmaps</h2>
  <div id="nav-items"></div>
</nav>

<!-- Mindmap SVG -->
<svg id="mindmap"></svg>

<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.12/dist/browser/index.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.12/dist/index.js"></script>

<script>
// Configuration des mindmaps
const mindmaps = {
  "Alation Help Center Quick Start": {
    title: "Alation Help Center Quick Start",
    data: {
      content: "Alation Help Center Quick Start",
      children: [
        { content: "Overview" },
        { content: "Community" },
        { content: "Documentation" }
      ]
    }
  },

  "Get to Know Alation": {
    title: "Get to Know Alation",
    data: {
      content: "Get to Know Alation",
      children: [
        { content: "What is Alation?" },
        { content: "Finding Relevant Data" },
        { content: "Trusting the Data" }
      ]
    }
  },

  "ACS - Data Catalog Basics": {
    title: "ACS - Data Catalog Basics",
    data: {
      content: "ACS - Data Catalog Basics",
      children: [
        { content: "Catalog Overview" },
        { content: "Tags & Documentation" }
      ]
    }
  },

  "ACS - Catalog Search": {
    title: "ACS - Catalog Search",
    data: {
      content: "ACS - Catalog Search",
      children: [
        { content: "Search Basics" },
        { content: "Saved Searches" }
      ]
    }
  },

  "Data Domains": {
    title: "Data Domains",
    data: {
      content: "Data Domains",
      children: [
        { content: "Create Domains" },
        { content: "Domain Members" }
      ]
    }
  },

  "Customize Your Catalog": {
    title: "Customize Your Catalog",
    data: {
      content: "Customize Your Catalog",
      children: [
        { content: "Custom Fields" },
        { content: "Templates" }
      ]
    }
  },

  "ACS - Document Hubs": {
    title: "ACS - Document Hubs",
    data: {
      content: "ACS - Document Hubs",
      children: [
        { content: "Manage Documents" },
        { content: "Search" }
      ]
    }
  },

  "ACS - Catalog Users and Groups": {
    title: "ACS - Catalog Users and Groups",
    data: {
      content: "Users and Groups",
      children: [
        { content: "User Roles" },
        { content: "Groups" }
      ]
    }
  },

  "ACS - Home Page Customization": {
    title: "ACS - Home Page Customization",
    data: {
      content: "Home Page Customization",
      children: [
        { content: "Custom Blocks" },
        { content: "Branding" }
      ]
    }
  },

  "Alation Data Steward": {
    title: "Alation Data Steward",
    data: {
      content: "Data Steward",
      children: [
        { content: "Stewardship" },
        { content: "Curation" }
      ]
    }
  },

  "ACS - Lineage Overview": {
    title: "ACS - Lineage Overview",
    data: {
      content: "Lineage Overview",
      children: [
        { content: "Dataflow Objects" },
        { content: "Impact Analysis" }
      ]
    }
  },

  "ACS - Manual Lineage": {
    title: "ACS - Manual Lineage",
    data: {
      content: "Manual Lineage",
      children: [
        { content: "Editor" },
        { content: "Bulk Upload" }
      ]
    }
  },

  "Writing Queries in Compose": {
    title: "Writing Queries in Compose",
    data: {
      content: "Compose",
      children: [
        { content: "Queries" },
        { content: "Joins" }
      ]
    }
  },

  "Query Results": {
    title: "Query Results",
    data: {
      content: "Query Results",
      children: [
        { content: "Execution" },
        { content: "Curation" }
      ]
    }
  },

  "Suggestion Analytics": {
    title: "Suggestion Analytics",
    data: {
      content: "Suggestion Analytics",
      children: [
        { content: "Allie Suggestions" }
      ]
    }
  },

  "Mastering Alation Analytics": {
    title: "Mastering Alation Analytics",
    data: {
      content: "Alation Analytics",
      children: [
        { content: "Users" },
        { content: "Queries" }
      ]
    }
  },

  "Alation Data Products": {
    title: "Alation Data Products",
    data: {
      content: "Data Products",
      children: [
        { content: "YAML Creation" },
        { content: "Management" }
      ]
    }
  }
};

// Variables globales
let currentMarkmap = null;
let currentToolbar = null;

// Fonction pour charger une mindmap
function loadMindmap(key) {
  const config = mindmaps[key];
  if (!config) return;
  
  // Mettre à jour l'URL sans recharger la page
  const url = new URL(window.location);
  url.searchParams.set('map', key);
  window.history.pushState({}, '', url);
  
  // Nettoyer l'ancienne mindmap
  document.getElementById('mindmap').innerHTML = '';
  if (currentToolbar) {
    const oldToolbar = document.querySelector('.mm-toolbar');
    if (oldToolbar) oldToolbar.remove();
  }
  
  // Créer la nouvelle mindmap
  const { markmap } = window;
  currentMarkmap = markmap.Markmap.create(
    'svg#mindmap',
    markmap.deriveOptions(),
    config.data
  );
  
  // Ajouter la toolbar
  setTimeout(() => {
    currentToolbar = new markmap.Toolbar();
    currentToolbar.attach(currentMarkmap);
    const toolbarEl = currentToolbar.render();
    toolbarEl.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
    document.body.append(toolbarEl);
  });
  
  // Mettre à jour le menu actif
  document.querySelectorAll('.nav-item').forEach(item => {
    item.classList.remove('active');
  });
  document.querySelector(`[data-key="${key}"]`)?.classList.add('active');
  
  // Appliquer le thème sombre si nécessaire
  if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
    document.documentElement.classList.add('markmap-dark');
  }
}

// Générer le menu de navigation
function generateNav() {
  const navItems = document.getElementById('nav-items');
  navItems.innerHTML = '';
  
  Object.keys(mindmaps).forEach(key => {
    const div = document.createElement('div');
    div.className = 'nav-item';
    div.textContent = mindmaps[key].title;
    div.setAttribute('data-key', key);
    div.onclick = () => loadMindmap(key);
    navItems.appendChild(div);
  });
}

// Toggle menu mobile
document.getElementById('menu-toggle').onclick = function() {
  document.getElementById('nav-menu').classList.toggle('open');
};

// Initialisation
window.addEventListener('DOMContentLoaded', () => {
  generateNav();
  
  // Charger la mindmap depuis l'URL ou la première par défaut
  const urlParams = new URLSearchParams(window.location.search);
  const mapKey = urlParams.get('map') || Object.keys(mindmaps)[0];
  loadMindmap(mapKey);
});

// Gérer le bouton retour du navigateur
window.addEventListener('popstate', () => {
  const urlParams = new URLSearchParams(window.location.search);
  const mapKey = urlParams.get('map') || Object.keys(mindmaps)[0];
  loadMindmap(mapKey);
});
</script>

</body>
</html>
